<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>抓取Kindle电子书销售排行榜 | x_shmily</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本程序通过R包XML抓取Kindle电子书销售排行榜，分为付费和免费两类。
准备工作12install.packages(XML)library(XML)">
<meta property="og:type" content="article">
<meta property="og:title" content="抓取Kindle电子书销售排行榜">
<meta property="og:url" content="http://datarting.com/2016/01/26/kindle_book_sort_crawler/index.html">
<meta property="og:site_name" content="x_shmily">
<meta property="og:description" content="本程序通过R包XML抓取Kindle电子书销售排行榜，分为付费和免费两类。
准备工作12install.packages(XML)library(XML)">
<meta property="og:image" content="http://7xqa0i.com1.z0.glb.clouddn.com/kindle_pay_sort.png">
<meta property="og:image" content="http://7xqa0i.com1.z0.glb.clouddn.com/kindle_free_sort.png">
<meta property="og:updated_time" content="2016-01-26T20:41:56.083Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="抓取Kindle电子书销售排行榜">
<meta name="twitter:description" content="本程序通过R包XML抓取Kindle电子书销售排行榜，分为付费和免费两类。
准备工作12install.packages(XML)library(XML)">
  
    <link rel="alternative" href="/atom.xml" title="x_shmily" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">x_shmily</a></h1>
        </hgroup>

        
        <p class="header-subtitle">不忘初心，方得始终。</p>
        
        
        <form><input type="text" class="search" placeholder=" Search..."></form>
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:itisshmily@gmail.com" title="Email"></a></li>
                            
                                <li id="知乎"><a class="知乎" target="_blank" href="https://www.zhihu.com/people/xshmily" title="知乎"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/u/2615369113" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/itisshmily" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/R/" style="font-size: 20px;">R</a> <a href="/tags/并行计算/" style="font-size: 10px;">并行计算</a> <a href="/tags/数据分析/" style="font-size: 10px;">数据分析</a> <a href="/tags/数据挖掘/" style="font-size: 10px;">数据挖掘</a> <a href="/tags/数据预处理/" style="font-size: 10px;">数据预处理</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/缺失值/" style="font-size: 10px;">缺失值</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://ripeconan.com/">Ripeconan</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">x_shmily</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/avatar.png" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">x_shmily</a></h1>
            </hgroup>
            
            <p class="header-subtitle">不忘初心，方得始终。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:itisshmily@gmail.com" title="Email"></a></li>
                            
                                <li id="知乎"><a class="知乎" target="_blank" href="https://www.zhihu.com/people/xshmily" title="知乎"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/u/2615369113" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/itisshmily" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-kindle_book_sort_crawler" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/26/kindle_book_sort_crawler/" class="article-date">
      <time datetime="2016-01-26T14:09:05.000Z" itemprop="datePublished">2016-01-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      抓取Kindle电子书销售排行榜
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/R/">R</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据挖掘/">数据挖掘</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/爬虫/">爬虫</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>本程序通过R包XML抓取Kindle电子书销售排行榜，分为付费和免费两类。</p>
<h1 id="u51C6_u5907_u5DE5_u4F5C"><a href="#u51C6_u5907_u5DE5_u4F5C" class="headerlink" title="准备工作"></a>准备工作</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install.packages(XML)</span><br><span class="line"><span class="keyword">library</span>(XML)</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="u83B7_u53D6_u7F51_u5740"><a href="#u83B7_u53D6_u7F51_u5740" class="headerlink" title="获取网址"></a>获取网址</h1><p>首先获取所需爬取的网址</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">page &lt;- <span class="number">1</span>:<span class="number">5</span>     <span class="comment">#总页数</span></span><br><span class="line">urllist &lt;- paste(<span class="string">"http://www.amazon.cn/gp/bestsellers/digital-text/116169071/ref=zg_bs_116169071_pg_"</span>, page, <span class="string">"?ie=UTF8&amp;pg="</span>, page, sep=<span class="string">""</span>)     <span class="comment">#构建每一页网址</span></span><br></pre></td></tr></table></figure>
<p>然后抓取页面，并将其转换为XML格式</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">webpage &lt;- htmlParse(urllist[<span class="number">1</span>], encoding=<span class="string">"UTF-8"</span>)</span><br><span class="line">pagexml &lt;- xmlRoot(webpage)</span><br></pre></td></tr></table></figure>
<p>此时可以先看一下网页源码的内容，以下为一本书的html源码<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=<span class="string">"zg_item_compact"</span>&gt;</span><br><span class="line">	&lt;div class=<span class="string">"zg_image zg_itemLeftDiv_compact"</span>&gt;</span><br><span class="line">		&lt;div class=<span class="string">"zg_itemImage_compact"</span>&gt;</span><br><span class="line">			&lt;a  href=<span class="string">"http://www.amazon.cn/<span class="variable">%E8</span><span class="variable">%A7</span><span class="variable">%A3</span><span class="variable">%E5</span><span class="variable">%BF</span><span class="variable">%A7</span><span class="variable">%E6</span><span class="variable">%9D</span><span class="variable">%82</span><span class="variable">%E8</span><span class="variable">%B4</span><span class="variable">%A7</span><span class="variable">%E5</span><span class="variable">%BA</span><span class="variable">%97</span>-<span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%9C</span><span class="variable">%E9</span><span class="variable">%87</span><span class="variable">%8E</span><span class="variable">%E5</span><span class="variable">%9C</span><span class="variable">%AD</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%BE</span>/dp/B00NOQNHP2/ref=zg_bs_116169071_1"</span>&gt;</span><br><span class="line">				&lt;img src=<span class="string">"http://ec4.images-amazon.com/images/I/51F6FK4cLGL._SL160_SL135_.jpg"</span> alt=<span class="string">"解忧杂货店"</span> title=<span class="string">"解忧杂货店"</span> onload=<span class="string">"if (typeof uet == 'function') &#123; uet('af'); &#125;"</span>/&gt;</span><br><span class="line">			&lt;<span class="regexp">/a&gt;</span><br><span class="line">		&lt;/div</span>&gt;</span><br><span class="line">	&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;div class="zg_itemRightDiv_compact"&gt;</span><br><span class="line">&lt;div class="zg_rankLine"&gt;</span><br><span class="line">	&lt;span class="zg_rankNumber"&gt;1.&lt;/span</span>&gt;</span><br><span class="line">	&lt;span class=<span class="string">"zg_rankMeta"</span>&gt;&lt;<span class="regexp">/span&gt;</span><br><span class="line">&lt;/div</span>&gt;</span><br><span class="line">&lt;div class=<span class="string">"zg_title"</span>&gt;</span><br><span class="line">	&lt;a  href=<span class="string">"http://www.amazon.cn/<span class="variable">%E8</span><span class="variable">%A7</span><span class="variable">%A3</span><span class="variable">%E5</span><span class="variable">%BF</span><span class="variable">%A7</span><span class="variable">%E6</span><span class="variable">%9D</span><span class="variable">%82</span><span class="variable">%E8</span><span class="variable">%B4</span><span class="variable">%A7</span><span class="variable">%E5</span><span class="variable">%BA</span><span class="variable">%97</span>-<span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%9C</span><span class="variable">%E9</span><span class="variable">%87</span><span class="variable">%8E</span><span class="variable">%E5</span><span class="variable">%9C</span><span class="variable">%AD</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%BE</span>/dp/B00NOQNHP2/ref=zg_bs_116169071_1"</span>&gt;解忧杂货店&lt;<span class="regexp">/a&gt;</span><br><span class="line">&lt;/div</span>&gt;</span><br><span class="line">&lt;div class=<span class="string">"zg_byline"</span>&gt;~ 东野圭吾 (作者), 李盈春 (译者)&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;div class="zg_reviews"&gt;</span><br><span class="line">	&lt;span class="zeitgeistB00NOQNHP2"&gt;</span><br><span class="line">		&lt;span class="a-declarative" data-action="a-popover" data-a-popover="&#123;&amp;quot;closeButton&amp;quot;:&amp;quot;false&amp;quot;,&amp;quot;max-width&amp;quot;:&amp;quot;700&amp;quot;,&amp;quot;position&amp;quot;:&amp;quot;triggerBottom&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;/review</span><span class="regexp">/widgets/average</span>-customer-review/popover/<span class="keyword">ref</span>=acr_zeitgeist__popover?ie=UTF8&amp;amp;asin=B00NOQNHP2&amp;amp;colid=&amp;amp;coliid=&amp;amp;contextId=zeitgeist&amp;amp;<span class="keyword">ref</span>=acr_zeitgeist__popover&amp;quot;&#125;<span class="string">"&gt;</span><br><span class="line">			&lt;a class="</span>a-<span class="keyword">link</span>-normal a-text-normal<span class="string">" href="</span>http:<span class="regexp">//www</span>.amazon.cn/product-reviews/B00NOQNHP2/<span class="keyword">ref</span>=acr_zeitgeist_text?ie=UTF8&amp;showViewpoints=<span class="number">1</span><span class="string">"&gt;</span><br><span class="line">				&lt;i class="</span>a-icon a-icon-star a-star-<span class="number">4</span>-<span class="number">5</span><span class="string">"&gt;</span><br><span class="line">					&lt;span class="</span>a-icon-alt<span class="string">"&gt;平均4.7 星&lt;/span&gt;</span><br><span class="line">				&lt;/i&gt;</span><br><span class="line">			&lt;/a&gt;</span><br><span class="line">		&lt;/span&gt;</span><br><span class="line">		&lt;span class="</span>a-size-small<span class="string">"&gt;</span><br><span class="line">			(&lt;a class="</span>a-<span class="keyword">link</span>-normal<span class="string">" href="</span>http:<span class="regexp">//www</span>.amazon.cn/product-reviews/B00NOQNHP2/<span class="keyword">ref</span>=acr_zeitgeist_text?ie=UTF8&amp;showViewpoints=<span class="number">1</span><span class="string">"&gt;6,905&lt;/a&gt;)</span><br><span class="line">		&lt;/span&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class="</span>zg_availability<span class="string">"&gt;现在可以下载。&lt;/div&gt;</span><br><span class="line">&lt;div class="</span>zg_itemPriceBlock_compact<span class="string">"&gt;</span><br><span class="line">	&lt;strong class="</span>price<span class="string">"&gt;￥ 6.40&lt;/strong&gt; &lt;br /&gt;</span><br><span class="line">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>因为在网页源码中，付费排行和免费排行不是分开的，而是付费免费混排，即112233….的模式。因此为方便起见，先取得奇数和偶数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">odd &lt;- seq(<span class="number">1</span>, <span class="number">40</span>, by = <span class="number">2</span>)  <span class="comment">#奇数</span></span><br><span class="line">even &lt;- seq(<span class="number">2</span>, <span class="number">40</span>, by = <span class="number">2</span>)  <span class="comment">#偶数</span></span><br></pre></td></tr></table></figure>
<h1 id="u6293_u53D6_u4E66_u540D"><a href="#u6293_u53D6_u4E66_u540D" class="headerlink" title="抓取书名"></a>抓取书名</h1><p>从源码里面可以看到书名的标签为<code>&lt;div class=&quot;zg_title&quot;&gt;解忧杂货店&lt;/div&gt;</code>。因此，可以通过“//div [@class=’zg_title’]”来选取，表示选取所有 div元素，且这些元素拥有值为zg_title的class属性。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">obtain_name &lt;- <span class="keyword">function</span>(pagexml)&#123;</span><br><span class="line">	bookname &lt;- xpathSApply (pagexml, <span class="string">"//div [@class='zg_title']"</span>, xmlValue)     <span class="comment">#抓取标签内内容</span></span><br><span class="line">	name_pay &lt;- bookname[odd]     <span class="comment">#获取付费排行书名</span></span><br><span class="line">	name_free &lt;- bookname[even]     <span class="comment">#获取免费排行书名</span></span><br><span class="line">	<span class="keyword">return</span>(data.frame(name_pay, name_free))</span><br><span class="line">&#125;</span><br><span class="line">obtain_name(pagexml)$name_pay</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##                                                                                                                                          name_pay</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>                                                                                                                                      解忧杂货店</span></span><br><span class="line"><span class="preprocessor">## <span class="number">2</span>                                                                                                                                    一个人的朝圣</span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>                                                                                                                    福尔摩斯探案全集(套装共<span class="number">11</span>册)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>                                                           外国经典原著荟萃（了不起的盖茨比+美妙的新世界+动物庄园+我们+<span class="number">1984</span>）双语版（套装共<span class="number">5</span>册）</span></span><br><span class="line"><span class="preprocessor">## <span class="number">5</span>                                                                                                      自卑与超越：你要清楚自己应该怎样过好这一生</span></span><br><span class="line"><span class="preprocessor">## <span class="number">6</span>                                                    你一定爱读的极简欧洲史（简约不简单的“最短”欧洲史，任志强、钱理群、钱文忠、公孙策联合推荐！）</span></span><br><span class="line"><span class="preprocessor">## <span class="number">7</span>                                                                                                                                      乖，摸摸头</span></span><br><span class="line"><span class="preprocessor">## <span class="number">8</span>                                                                                              你不可错过的<span class="number">32</span>部欧美文学不朽名作 (Fountain·泉系列)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">9</span>                                                                                                                                        三体全集</span></span><br><span class="line"><span class="preprocessor">## <span class="number">10</span>                        中国历史那些事儿系列套装：明朝那些事儿（全<span class="number">7</span>册）、这里曾经是汉朝（全<span class="number">6</span>册）、唐史并不如烟（全<span class="number">5</span>册）、如果这是宋史（全<span class="number">10</span>册）</span></span><br><span class="line"><span class="preprocessor">## <span class="number">11</span>                                                                         无声告白（<span class="number">2014</span>美国亚马逊最佳图书第<span class="number">1</span>名） (读客全球顶级畅销小说文库 <span class="number">218</span>)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">12</span>                                                                                                                                         失乐园</span></span><br><span class="line"><span class="preprocessor">## <span class="number">13</span>                                                                                                                                         白夜行</span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>                                                                                                                                     蒋勋说宋词</span></span><br><span class="line"><span class="preprocessor">## <span class="number">15</span>                                                                                                        House of Cards (House of Cards Trilogy)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">16</span> 岛上书店（现象级全球畅销书！美国独立书商选书第<span class="number">1</span>名！每个人的生命中，都有最艰难的那一年，将人生变得美好而辽阔。） (读客全球顶级畅销小说文库 <span class="number">137</span>)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">17</span>                                                                                                                                     追风筝的人</span></span><br><span class="line"><span class="preprocessor">## <span class="number">18</span>                                                                                                                                       未来边缘</span></span><br><span class="line"><span class="preprocessor">## <span class="number">19</span>                                                                               古龙作品文集（大陆唯一合法授权）（精装<span class="number">72</span>册）（读客知识小说文库）</span></span><br><span class="line"><span class="preprocessor">## <span class="number">20</span>                                                                                                                        明朝那些事儿(套装全<span class="number">7</span>册)</span></span><br></pre></td></tr></table></figure>
<p>下面抓取作者、价格、评价以及评价数方法与此类似，直接上代码加注释。</p>
<h1 id="u6293_u53D6_u4F5C_u8005"><a href="#u6293_u53D6_u4F5C_u8005" class="headerlink" title="抓取作者"></a>抓取作者</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">obtain_author &lt;- <span class="keyword">function</span>(pagexml)&#123;</span><br><span class="line">	bookauthor &lt;- xpathSApply (pagexml, <span class="string">"//div [@class='zg_byline']"</span>, xmlValue)</span><br><span class="line">	bookauthor &lt;- sub(<span class="string">"\n\n\n\n\n\n\n~ "</span>, <span class="string">""</span>, bookauthor)     <span class="comment">#sub为字符串替换函数，将抓取出的作者中无效字符删除</span></span><br><span class="line">	author_pay &lt;- bookauthor[odd]     <span class="comment">#获取付费排行作者</span></span><br><span class="line">	author_free &lt;- bookauthor[even]     <span class="comment">#获取免费排行作者</span></span><br><span class="line">	<span class="keyword">return</span>(data.frame(author_pay, author_free))</span><br><span class="line">&#125;</span><br><span class="line">obtain_author(pagexml)$author_pay</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##                                                              author_pay</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>                                        东野圭吾 (作者), 李盈春 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">2</span>  蕾秋&lt;U+<span class="number">2022</span>&gt;乔伊斯(Rachel Joyce) 著，黄妙瑜 译 (作者), 黄妙瑜 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>                                      柯南道尔 (Conan Doyle A.) (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>        （美）菲茨杰拉德；赫胥黎；乔治·奥威尔；扎米亚金；奥威尔 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">5</span>                         【奥】阿尔弗雷德·阿德勒 (作者), 马晓娜 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">6</span>                              约翰&lt;U+<span class="number">2022</span>&gt;赫斯特 (作者), 席玉苹 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">7</span>                                                           大冰 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">8</span>                                     莎士比亚 等 (作者), 邵明鉴 (编者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">9</span>                                                         刘慈欣 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">10</span>     当年明月 (作者), 月望东山 (作者), 曲昌春 (作者), 高天流云 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">11</span>                伍绮诗 (作者) (作者), 孙璐 (译者) (作者), 孙璐 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">12</span>                                       渡边淳一 (作者), 竺家荣 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">13</span>                     东野圭吾 (Higashino Keigo) (作者), 刘姿君 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>                                                          蒋勋 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">15</span>                                                 Michael Dobbs (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">16</span>          加布瑞埃拉&lt;U+<span class="number">2022</span>&gt;泽文 (作者), 孙仲旭 (译者), 李玉瑶 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">17</span>               卡勒德·胡赛尼（Khaled Hosseini） (作者), 李继宏 (译者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">18</span>                                                        刘慈欣 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">19</span>                                                          古龙 (作者)</span></span><br><span class="line"><span class="preprocessor">## <span class="number">20</span>                                                      当年明月 (作者)</span></span><br></pre></td></tr></table></figure>
<h1 id="u6293_u53D6_u4ED8_u8D39_u56FE_u4E66_u4EF7_u683C"><a href="#u6293_u53D6_u4ED8_u8D39_u56FE_u4E66_u4EF7_u683C" class="headerlink" title="抓取付费图书价格"></a>抓取付费图书价格</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">obtain_price &lt;- <span class="keyword">function</span>(pagexml)&#123;</span><br><span class="line">	bookprice &lt;- xpathSApply (pagexml, <span class="string">"//strong [@class='price']"</span>, xmlValue)</span><br><span class="line">	bookprice &lt;- bookprice[odd]     <span class="comment">#去掉免费图书的价格</span></span><br><span class="line">	bookprice &lt;- unlist(strsplit(bookprice,<span class="string">" "</span>))[even]     <span class="comment">#处理数据，去除¥。strsplit为字符串拆分函数，此时以空格拆分字符串</span></span><br><span class="line">	price &lt;- as.numeric(bookprice)     <span class="comment">#转为数字</span></span><br><span class="line">	<span class="keyword">return</span>(price)</span><br><span class="line">&#125;</span><br><span class="line">obtain_price(pagexml)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##  [<span class="number">1</span>]  <span class="number">6.40</span>  <span class="number">0.90</span>  <span class="number">0.99</span>  <span class="number">0.10</span>  <span class="number">0.99</span>  <span class="number">3.99</span>  <span class="number">2.99</span> <span class="number">79.20</span> <span class="number">17.99</span> <span class="number">88.59</span>  <span class="number">8.99</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">12</span>]  <span class="number">1.99</span>  <span class="number">8.99</span>  <span class="number">2.99</span>  <span class="number">9.99</span>  <span class="number">8.99</span>  <span class="number">3.99</span>  <span class="number">0.99</span>  <span class="number">4.50</span>  <span class="number">8.99</span></span></span><br></pre></td></tr></table></figure>
<h1 id="u6293_u53D6_u8BC4_u4EF7"><a href="#u6293_u53D6_u8BC4_u4EF7" class="headerlink" title="抓取评价"></a>抓取评价</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">obtain_evaluate &lt;- <span class="keyword">function</span>(pagexml) &#123;</span><br><span class="line">	evaluate &lt;- xpathSApply (pagexml, <span class="string">"//span [@class='a-icon-alt']"</span>, xmlValue)</span><br><span class="line">	evaluate &lt;- sub(<span class="string">"平均"</span>, <span class="string">""</span>, evaluate)     <span class="comment">#处理字符串，删除“平均”</span></span><br><span class="line">	evaluate &lt;- sub(<span class="string">" 星"</span>, <span class="string">""</span>, evaluate)     <span class="comment">#处理字符串，删除“ 星”</span></span><br><span class="line">	evaluate &lt;- as.numeric(evaluate)     <span class="comment">#转为数字</span></span><br><span class="line">	evaluate_pay &lt;- evaluate[odd]     <span class="comment">#获取付费排行评价</span></span><br><span class="line">	evaluate_free &lt;- evaluate[even]     <span class="comment">#获取免费排行评价</span></span><br><span class="line">	<span class="keyword">return</span>(data.frame(evaluate_pay, evaluate_free))</span><br><span class="line">&#125;</span><br><span class="line">obtain_evaluate(pagexml)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##    evaluate_pay evaluate_free</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>           <span class="number">4.7</span>           <span class="number">4.3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">2</span>           <span class="number">4.6</span>           <span class="number">4.0</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>           <span class="number">4.2</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>           <span class="number">3.3</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">5</span>           <span class="number">4.6</span>           <span class="number">4.3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">6</span>           <span class="number">4.4</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">7</span>           <span class="number">4.7</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">8</span>           <span class="number">4.3</span>           <span class="number">4.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">9</span>           <span class="number">4.5</span>           <span class="number">4.5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">10</span>          <span class="number">4.0</span>           <span class="number">4.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">11</span>          <span class="number">4.6</span>           <span class="number">4.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">12</span>          <span class="number">4.5</span>           <span class="number">4.5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">13</span>          <span class="number">4.7</span>           <span class="number">4.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>          <span class="number">4.4</span>           <span class="number">5.0</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">15</span>          <span class="number">4.0</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">16</span>          <span class="number">4.5</span>           <span class="number">4.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">17</span>          <span class="number">4.6</span>           <span class="number">4.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">18</span>          <span class="number">4.4</span>           <span class="number">4.7</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">19</span>          <span class="number">4.7</span>           <span class="number">3.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">20</span>          <span class="number">4.4</span>           <span class="number">4.6</span></span></span><br></pre></td></tr></table></figure>
<h1 id="u6293_u53D6_u8BC4_u4EF7_u6570"><a href="#u6293_u53D6_u8BC4_u4EF7_u6570" class="headerlink" title="抓取评价数"></a>抓取评价数</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">obtain_evaluate_num &lt;- <span class="keyword">function</span>(pagexml)&#123;</span><br><span class="line">	evaluate_num &lt;- xpathSApply (pagexml, <span class="string">"//a [@class='a-link-normal']"</span>, xmlValue)</span><br><span class="line">	evaluate_num &lt;- sub(<span class="string">","</span>, <span class="string">""</span>, evaluate_num)  <span class="comment">#sub为字符串替换函数，将数字中间的逗号(,)替换成空，即删除逗号</span></span><br><span class="line">	evaluate_num &lt;- as.numeric(evaluate_num)  <span class="comment">#转为数字</span></span><br><span class="line">	evaluate_num_pay &lt;- evaluate_num[odd]     <span class="comment">#获取付费排行评价数</span></span><br><span class="line">	evaluate_num_free &lt;- evaluate_num[even]     <span class="comment">#获取免费排行评价数</span></span><br><span class="line">	<span class="keyword">return</span>(data.frame(evaluate_num_pay, evaluate_num_free))</span><br><span class="line">&#125;</span><br><span class="line">obtain_evaluate_num(pagexml)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##    evaluate_num_pay evaluate_num_free</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>              <span class="number">6907</span>              <span class="number">2370</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">2</span>              <span class="number">2036</span>               <span class="number">343</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>                <span class="number">71</span>                <span class="number">25</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>                <span class="number">19</span>               <span class="number">737</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">5</span>               <span class="number">110</span>              <span class="number">1909</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">6</span>              <span class="number">1680</span>               <span class="number">645</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">7</span>              <span class="number">4118</span>               <span class="number">852</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">8</span>                <span class="number">16</span>               <span class="number">328</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">9</span>              <span class="number">1716</span>               <span class="number">434</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">10</span>               <span class="number">24</span>               <span class="number">337</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">11</span>             <span class="number">1243</span>               <span class="number">818</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">12</span>              <span class="number">464</span>               <span class="number">625</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">13</span>             <span class="number">3820</span>               <span class="number">617</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>              <span class="number">133</span>                 <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">15</span>               <span class="number">55</span>               <span class="number">209</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">16</span>             <span class="number">1885</span>               <span class="number">211</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">17</span>            <span class="number">11686</span>               <span class="number">205</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">18</span>              <span class="number">145</span>               <span class="number">346</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">19</span>              <span class="number">135</span>               <span class="number">478</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">20</span>             <span class="number">2344</span>               <span class="number">525</span></span></span><br></pre></td></tr></table></figure>
<h1 id="u4E3B_u7A0B_u5E8F"><a href="#u4E3B_u7A0B_u5E8F" class="headerlink" title="主程序"></a>主程序</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">kindle_pay_sort &lt;- data.frame()     <span class="comment">#产生初始输出数据框</span></span><br><span class="line">kindle_free_sort &lt;- data.frame()</span><br><span class="line">page &lt;- <span class="number">1</span>:<span class="number">5</span></span><br><span class="line">urllist &lt;- paste(<span class="string">"http://www.amazon.cn/gp/bestsellers/digital-text/116169071/ref=zg_bs_116169071_pg_"</span>, page, <span class="string">"?ie=UTF8&amp;pg="</span>, page, sep=<span class="string">""</span>)</span><br><span class="line">odd &lt;- seq(<span class="number">1</span>, <span class="number">40</span>, by = <span class="number">2</span>)  <span class="comment">#奇数</span></span><br><span class="line">even &lt;- seq(<span class="number">2</span>, <span class="number">40</span>, by = <span class="number">2</span>)  <span class="comment">#偶数</span></span><br><span class="line"><span class="keyword">for</span>(URL <span class="keyword">in</span> urllist)&#123;</span><br><span class="line">	webpage &lt;- htmlParse(URL, encoding=<span class="string">"UTF-8"</span>)</span><br><span class="line">	pagexml &lt;- xmlRoot(webpage)</span><br><span class="line">	name &lt;- obtain_name(pagexml)</span><br><span class="line">	author &lt;- obtain_author(pagexml)</span><br><span class="line">	price &lt;- obtain_price(pagexml)</span><br><span class="line">	evaluate &lt;- obtain_evaluate(pagexml)</span><br><span class="line">	evaluate_num &lt;- obtain_evaluate_num(pagexml)</span><br><span class="line">	kindle_pay_sort_pro &lt;- data.frame(name$name_pay, author$author_pay, price, evaluate$evaluate_pay, evaluate_num$evaluate_num_pay)</span><br><span class="line">	kindle_free_sort_pro &lt;- data.frame(name$name_free, author$author_free, evaluate$evaluate_free, evaluate_num$evaluate_num_free)</span><br><span class="line">	kindle_pay_sort &lt;- rbind(kindle_pay_sort, kindle_pay_sort_pro)</span><br><span class="line">	kindle_free_sort &lt;- rbind(kindle_free_sort, kindle_free_sort_pro)</span><br><span class="line">	Sys.sleep(runif(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>))     <span class="comment">#暂停执行一定的时间间隔，防止被amazon识别为机器爬取。runif产生均匀分布随机数</span></span><br><span class="line">&#125;</span><br><span class="line">names(kindle_pay_sort)&lt;-c(<span class="string">"书名"</span>, <span class="string">"作者"</span>, <span class="string">"价格"</span>, <span class="string">"评价"</span>, <span class="string">"评价数"</span>)</span><br><span class="line">names(kindle_free_sort)&lt;-c(<span class="string">"书名"</span>, <span class="string">"作者"</span>, <span class="string">"评价"</span>, <span class="string">"评价数"</span>)</span><br><span class="line">write.csv(kindle_pay_sort,file=<span class="string">"kindle_pay_sort.csv"</span>)</span><br><span class="line">write.csv(kindle_free_sort,file=<span class="string">"kindle_free_sort.csv"</span>)</span><br></pre></td></tr></table></figure>
<p>这样就分别得到了付费排名和免费排名两份文件。如下</p>
<p><img src="http://7xqa0i.com1.z0.glb.clouddn.com/kindle_pay_sort.png" alt="付费排序"><br><img src="http://7xqa0i.com1.z0.glb.clouddn.com/kindle_free_sort.png" alt="免费排序"></p>

      
    </div>
    
  </div>
  
    


    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/01/28/r_parallel_computing/">
                    R语言parallel包处理并行运算
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/01/19/missing_value/">
                    R语言处理缺失数据
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#u51C6_u5907_u5DE5_u4F5C"><span class="toc-number">1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u83B7_u53D6_u7F51_u5740"><span class="toc-number">2.</span> <span class="toc-text">获取网址</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u6293_u53D6_u4E66_u540D"><span class="toc-number">3.</span> <span class="toc-text">抓取书名</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u6293_u53D6_u4F5C_u8005"><span class="toc-number">4.</span> <span class="toc-text">抓取作者</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u6293_u53D6_u4ED8_u8D39_u56FE_u4E66_u4EF7_u683C"><span class="toc-number">5.</span> <span class="toc-text">抓取付费图书价格</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u6293_u53D6_u8BC4_u4EF7"><span class="toc-number">6.</span> <span class="toc-text">抓取评价</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u6293_u53D6_u8BC4_u4EF7_u6570"><span class="toc-number">7.</span> <span class="toc-text">抓取评价数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u4E3B_u7A0B_u5E8F"><span class="toc-number">8.</span> <span class="toc-text">主程序</span></a></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>




<div class="share">
    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
    <a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
    <a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
    <a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
    </div>
    <script>
        window._bd_share_config={
            "common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>
</div>



    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/01/26/kindle_book_sort_crawler/" data-title="抓取Kindle电子书销售排行榜" data-url="http://datarting.com/2016/01/26/kindle_book_sort_crawler/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"itisshmily"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/01/28/r_parallel_computing/" title="上一篇: R语言parallel包处理并行运算">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/01/19/missing_value/" title="下一篇: R语言处理缺失数据">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/01/28/r_parallel_computing/">R语言parallel包处理并行运算</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/kindle_book_sort_crawler/">抓取Kindle电子书销售排行榜</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/19/missing_value/">R语言处理缺失数据</a></li></ul>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 x_shmily
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>