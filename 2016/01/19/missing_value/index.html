<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>R语言处理缺失数据 | x_shmily</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在收集的真实数据中，数据缺失是非常常见的现象，而且会对之后的数据分析产生较大影响，因而缺失值的处理是数据预处理的重要内容之一。基本上，缺失数据处理的流程是，首先判断其模式是否随机，然后找出缺失的原因，最后对缺失值进行处理。
这里主要用到VIM和mice包。并利用VIM包里的sleep数据集。">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言处理缺失数据">
<meta property="og:url" content="http://datarting.com/2016/01/19/missing_value/index.html">
<meta property="og:site_name" content="x_shmily">
<meta property="og:description" content="在收集的真实数据中，数据缺失是非常常见的现象，而且会对之后的数据分析产生较大影响，因而缺失值的处理是数据预处理的重要内容之一。基本上，缺失数据处理的流程是，首先判断其模式是否随机，然后找出缺失的原因，最后对缺失值进行处理。
这里主要用到VIM和mice包。并利用VIM包里的sleep数据集。">
<meta property="og:image" content="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-1.png">
<meta property="og:image" content="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-2.png">
<meta property="og:image" content="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-3.png">
<meta property="og:updated_time" content="2016-01-20T07:08:21.798Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="R语言处理缺失数据">
<meta name="twitter:description" content="在收集的真实数据中，数据缺失是非常常见的现象，而且会对之后的数据分析产生较大影响，因而缺失值的处理是数据预处理的重要内容之一。基本上，缺失数据处理的流程是，首先判断其模式是否随机，然后找出缺失的原因，最后对缺失值进行处理。
这里主要用到VIM和mice包。并利用VIM包里的sleep数据集。">
  
    <link rel="alternative" href="/atom.xml" title="x_shmily" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">x_shmily</a></h1>
        </hgroup>

        
        <p class="header-subtitle">不忘初心，方得始终。</p>
        
        
        <form><input type="text" class="search" placeholder=" Search..."></form>
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:itisshmily@gmail.com" title="Email"></a></li>
                            
                                <li id="知乎"><a class="知乎" target="_blank" href="https://www.zhihu.com/people/xshmily" title="知乎"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/u/2615369113" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/itisshmily" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/R/" style="font-size: 20px;">R</a> <a href="/tags/并行计算/" style="font-size: 10px;">并行计算</a> <a href="/tags/数据分析/" style="font-size: 10px;">数据分析</a> <a href="/tags/数据挖掘/" style="font-size: 10px;">数据挖掘</a> <a href="/tags/数据预处理/" style="font-size: 10px;">数据预处理</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/缺失值/" style="font-size: 10px;">缺失值</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://ripeconan.com/">Ripeconan</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">x_shmily</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/avatar.png" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">x_shmily</a></h1>
            </hgroup>
            
            <p class="header-subtitle">不忘初心，方得始终。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:itisshmily@gmail.com" title="Email"></a></li>
                            
                                <li id="知乎"><a class="知乎" target="_blank" href="https://www.zhihu.com/people/xshmily" title="知乎"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/u/2615369113" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/itisshmily" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-missing_value" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/19/missing_value/" class="article-date">
      <time datetime="2016-01-19T12:55:29.000Z" itemprop="datePublished">2016-01-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      R语言处理缺失数据
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/数据分析/">数据分析</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据分析/">数据分析</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据预处理/">数据预处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缺失值/">缺失值</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在收集的真实数据中，数据缺失是非常常见的现象，而且会对之后的数据分析产生较大影响，因而缺失值的处理是数据预处理的重要内容之一。基本上，缺失数据处理的流程是，首先判断其模式是否随机，然后找出缺失的原因，最后对缺失值进行处理。</p>
<p>这里主要用到VIM和mice包。并利用VIM包里的sleep数据集。<br><a id="more"></a><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.<span class="function"><span class="title">packages</span><span class="params">(c(<span class="string">"VIM"</span>,<span class="string">"mice"</span>)</span></span>)</span><br></pre></td></tr></table></figure></p>
<h1 id="u5224_u65AD_u7F3A_u5931_u6570_u636E"><a href="#u5224_u65AD_u7F3A_u5931_u6570_u636E" class="headerlink" title="判断缺失数据"></a>判断缺失数据</h1><h2 id="u8BC6_u522B_u7F3A_u5931_u503C"><a href="#u8BC6_u522B_u7F3A_u5931_u503C" class="headerlink" title="识别缺失值"></a>识别缺失值</h2><p>R中缺失值以NA表示，判断数据是否存在缺失值的函数有两个is.na()和complete.cases()。</p>
<p>is.na()可以应用于向量、数据框等多种对象，返回逻辑值，若数据为缺失值则返回TRUE，否则为FALSE。</p>
<p>complete.cases()同样返回逻辑值，也可用来可用来识别矩阵或数据框中没有缺失值的行，但值与is.na()相反，缺失值为FALSE，正常数据为TRUE。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data(sleep,package=<span class="string">"VIM"</span>)</span><br><span class="line">is.na(sleep$Dream)</span><br><span class="line">complete.cases(sleep$Dream)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(is.na(sleep$Dream))</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">12</span></span></span><br></pre></td></tr></table></figure>
<p>用以上sum()函数可以知道Dream列一共有12个缺失值。</p>
<h2 id="u4E0D_u540C_u7C7B_u578B_u6570_u636E_u8FD4_u56DE_u503C_u793A_u4F8B"><a href="#u4E0D_u540C_u7C7B_u578B_u6570_u636E_u8FD4_u56DE_u503C_u793A_u4F8B" class="headerlink" title="不同类型数据返回值示例"></a>不同类型数据返回值示例</h2><p>NA：代表缺失值；</p>
<p>NaN：代表不可能的值；</p>
<p>Inf：代表正无穷；</p>
<p>-Inf：代表负无穷。</p>
<p>is.na()：识别缺失值；</p>
<p>is.nan()：识别不可能值；</p>
<p>is.infinite()：无穷值。</p>
<p>is.na()、is.nan()和is.infinite()函数的返回值示例：</p>
<table>
<thead>
<tr>
<th style="text-align:center">x</th>
<th style="text-align:center">is.na()</th>
<th style="text-align:center">is.nan()</th>
<th style="text-align:center">is.infinite()</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">x&lt;-NA</td>
<td style="text-align:center">TRUE</td>
<td style="text-align:center">FALSE</td>
<td style="text-align:center">FALSE</td>
</tr>
<tr>
<td style="text-align:center">x&lt;-0/0</td>
<td style="text-align:center">TRUE</td>
<td style="text-align:center">TRUE</td>
<td style="text-align:center">FALSE</td>
</tr>
<tr>
<td style="text-align:center">x&lt;-1/0</td>
<td style="text-align:center">FALSE</td>
<td style="text-align:center">FALSE</td>
<td style="text-align:center">TRUE</td>
</tr>
</tbody>
</table>
<h1 id="u5224_u65AD_u7F3A_u5931_u6A21_u5F0F"><a href="#u5224_u65AD_u7F3A_u5931_u6A21_u5F0F" class="headerlink" title="判断缺失模式"></a>判断缺失模式</h1><p>存在缺失数据时，需要进一步判断数据的缺失模式，判断是否是随机的，然后才能确定处理的方法。缺失值从缺失的分布来讲可以分为完全随机缺失，随机缺失和完全非随机缺失。</p>
<p>完全随机缺失(MCAR)指的是数据的缺失是随机的，数据的缺失不依赖于任何不完全变量或完全变量。</p>
<p>随机缺失(MAR)指的是数据的缺失不是完全随机的，即该类数据的缺失依赖于其他完全变量。</p>
<p>完全非随机缺失(MNAR)指的是数据的缺失依赖于不完全变量自身。</p>
<h2 id="u4ECE_u6570_u503C_u89D2_u5EA6"><a href="#u4ECE_u6570_u503C_u89D2_u5EA6" class="headerlink" title="从数值角度"></a>从数值角度</h2><p>可以利用mice包中的md.pattern()函数来判断缺失数据的模式。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">md.pattern(sleep)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##    BodyWgt BrainWgt Pred Exp Danger Sleep Span Gest Dream NonD   </span></span><br><span class="line"><span class="preprocessor">## <span class="number">42</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>  <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">2</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>  <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">3</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">1</span>    <span class="number">1</span>  <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">9</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>     <span class="number">0</span>    <span class="number">0</span>  <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">2</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>     <span class="number">1</span>    <span class="number">0</span>  <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">1</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">1</span>    <span class="number">1</span>  <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">2</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>     <span class="number">0</span>    <span class="number">0</span>  <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">##  <span class="number">1</span>       <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">1</span>     <span class="number">0</span>    <span class="number">0</span>  <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">##          <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span>     <span class="number">4</span>    <span class="number">4</span>    <span class="number">4</span>    <span class="number">12</span>   <span class="number">14</span> <span class="number">38</span></span></span><br></pre></td></tr></table></figure>
<p>“1”表示没有缺失数据，“0”表示存在缺失数据，第一列、最后一列和最后一行分别表示汇总。</p>
<h2 id="u56FE_u5F62_u65B9_u5F0F"><a href="#u56FE_u5F62_u65B9_u5F0F" class="headerlink" title="图形方式"></a>图形方式</h2><p>用图形能更加直观的表示，此时用到VIM包，它实现了缺失模式的可视化，其中包括aggr()、matrixplot()、marginplot()等函数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(VIM)</span><br><span class="line">aggr(sleep)</span><br></pre></td></tr></table></figure>
<p><img src="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-1.png" alt=""></p>
<p>第一张图显示了各变量缺失数据的比例。第二张图显示了综合的缺失模式，其中红色表示缺失数据。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matrixplot(sleep)</span><br></pre></td></tr></table></figure>
<p><img src="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-2.png" alt=""></p>
<p>浅色表示值小，深色表示值大，默认缺失值为红色。</p>
<p>此外，marginplot()函数可生成一幅散点图，在图形边界展示两个变量的缺失值信息。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">marginplot(sleep[c(<span class="string">"Span"</span>,<span class="string">"Dream"</span>)],pch=c(<span class="number">20</span>),col=c(<span class="string">"darkgray"</span>,<span class="string">"red"</span>,<span class="string">"blue"</span>))</span><br></pre></td></tr></table></figure>
<p><img src="http://7xqa0i.com1.z0.glb.clouddn.com/R%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE-3.png" alt=""></p>
<h1 id="u5904_u7406_u7F3A_u5931_u6570_u636E"><a href="#u5904_u7406_u7F3A_u5931_u6570_u636E" class="headerlink" title="处理缺失数据"></a>处理缺失数据</h1><p>处理缺失数据主要有以下三种方法：</p>
<h2 id="u5220_u9664_u7F3A_u5931_u6837_u672C"><a href="#u5220_u9664_u7F3A_u5931_u6837_u672C" class="headerlink" title="删除缺失样本"></a>删除缺失样本</h2><p>过滤掉缺失样本是最简单的方式，但前提是缺失数据的比例较少，且缺失数据是随机出现的，这样删除缺失样本后对分析结果的影响才会不大。</p>
<p>其中可以使用complete.cases()和is.na()选取完整的记录。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dim(sleep)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">62</span> <span class="number">10</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep_1&lt;-sleep[complete.cases(sleep$Dream),]</span><br><span class="line">dim(sleep_1)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">50</span> <span class="number">10</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep_2&lt;-sleep[!is.na(sleep$Dream),]</span><br><span class="line">dim(sleep_2)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">50</span> <span class="number">10</span></span></span><br></pre></td></tr></table></figure>
<p>可以看出，sleep数据集原来有62行，去掉12个Dream缺失后，还剩50行。</p>
<p>对于有多个变量缺失的数据，如果想直接删除所有的缺失值，可以通过na.omit()函数来完成。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep_3&lt;-na.omit(sleep)</span><br><span class="line">dim(sleep_3)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">42</span> <span class="number">10</span></span></span><br></pre></td></tr></table></figure>
<p>去掉所有有缺失值的记录之后，剩下42条完整数据。</p>
<h2 id="u66FF_u6362_u7F3A_u5931_u503C"><a href="#u66FF_u6362_u7F3A_u5931_u503C" class="headerlink" title="替换缺失值"></a>替换缺失值</h2><p>缺失值不一定要完全删除，最常见的是通过赋值来解决，用变量均值或者中位数来替代是常见的做法，这样做的优点在于不会减少样本信息，处理简单，但缺点是当缺失数据不是随机出现时会产生偏差。</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep<span class="variable">$Dream</span>[is.na(sleep<span class="variable">$Dream</span>)]&lt;-mean(sleep<span class="variable">$Dream</span>[!is.na(sleep<span class="variable">$Dream</span>)])</span><br><span class="line">sleep<span class="variable">$Dream</span>[is.na(sleep<span class="variable">$Dream</span>)]&lt;-median(sleep<span class="variable">$Dream</span>[!is.na(sleep<span class="variable">$Dream</span>)])</span><br></pre></td></tr></table></figure>
<h2 id="u591A_u91CD_u63D2_u8865_u6CD5"><a href="#u591A_u91CD_u63D2_u8865_u6CD5" class="headerlink" title="多重插补法"></a>多重插补法</h2><p>多重插补(Multiple Imputation)是用于填补复杂数据缺失值的一种方法，该方法通过变量间关系来预测缺失数据，利用蒙特卡洛随机模拟方法生成多个完整数据集，再对这些数据集分别进行分析，最后对这些分析结果进行汇总处理。</p>
<p>其基本思想是对每一个缺失值进行插补，重复m次得到m个插补值，再利用m个插补值估计缺失值。比较有代表性的插补算法有JM模型和FSC(Full Approaches Specification)。</p>
<p>JM模型对原始数据要求很高，需要数据服从多元正态分布。</p>
<p>这里主要介绍FSC方法，因为它的使用对数据分布没有要求，FSC是基于链式方程的插补方法。它与其他多重插补算法的本质区别在于，在进行插补时不必要考虑被插补变量和协变量的联合分布，而是利用单个变量的条件分布逐一进行插补。</p>
<p>R语言中可以通过mice包中的mice()函数可以实现，它随机模拟多个完整数据集存入imp，再对imp进行线性回归，最后利用pool()函数对回归结果汇总。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">imp&lt;-mice(sleep,seed=<span class="number">1234</span>)  <span class="comment">#随机模拟数据</span></span><br><span class="line">fit&lt;-with(imp,lm(Dream~Span+Gest))  <span class="comment">#线性回归</span></span><br><span class="line">pooled&lt;-pool(fit)  <span class="comment">#回归结果</span></span><br><span class="line">options(digits = <span class="number">3</span>)  <span class="comment">#显示小数点后三位</span></span><br><span class="line">summary(pooled)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##                  est      se      t   df Pr(&gt;|t|)    lo <span class="number">95</span>     hi <span class="number">95</span> nmis</span></span><br><span class="line"><span class="preprocessor">## (Intercept)  <span class="number">2.54620</span> <span class="number">0.25469</span>  <span class="number">9.997</span> <span class="number">52.1</span> <span class="number">1.02e-13</span>  <span class="number">2.03516</span>  <span class="number">3.057242</span>   NA</span></span><br><span class="line"><span class="preprocessor">## Span        -<span class="number">0.00455</span> <span class="number">0.01204</span> -<span class="number">0.378</span> <span class="number">51.9</span> <span class="number">7.07e-01</span> -<span class="number">0.02871</span>  <span class="number">0.019610</span>    <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## Gest        -<span class="number">0.00392</span> <span class="number">0.00147</span> -<span class="number">2.666</span> <span class="number">55.6</span> <span class="number">1.00e-02</span> -<span class="number">0.00686</span> -<span class="number">0.000973</span>    <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">##                fmi lambda</span></span><br><span class="line"><span class="preprocessor">## (Intercept) <span class="number">0.0871</span> <span class="number">0.0527</span></span></span><br><span class="line"><span class="preprocessor">## Span        <span class="number">0.0886</span> <span class="number">0.0542</span></span></span><br><span class="line"><span class="preprocessor">## Gest        <span class="number">0.0544</span> <span class="number">0.0210</span></span></span><br></pre></td></tr></table></figure>
<p>汇总结果和回归相似，nmis表示变量中缺失数据个数，fmi表示由缺失数据贡献的变异。</p>
<p>imp是一个包含m个插补数据集的列表对象，同时还含有完成插补过程的信息，默认的m=5。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## Multiply imputed data set</span></span><br><span class="line"><span class="preprocessor">## Call:</span></span><br><span class="line"><span class="preprocessor">## mice(data = sleep, seed = <span class="number">1234</span>)</span></span><br><span class="line"><span class="preprocessor">## Number of multiple imputations:  <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## Missing cells per column:</span></span><br><span class="line"><span class="preprocessor">##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred </span></span><br><span class="line"><span class="preprocessor">##        <span class="number">0</span>        <span class="number">0</span>       <span class="number">14</span>       <span class="number">12</span>        <span class="number">4</span>        <span class="number">4</span>        <span class="number">4</span>        <span class="number">0</span> </span></span><br><span class="line"><span class="preprocessor">##      Exp   Danger </span></span><br><span class="line"><span class="preprocessor">##        <span class="number">0</span>        <span class="number">0</span> </span></span><br><span class="line"><span class="preprocessor">## Imputation methods:</span></span><br><span class="line"><span class="preprocessor">##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred </span></span><br><span class="line"><span class="preprocessor">##       <span class="string">""</span>       <span class="string">""</span>    <span class="string">"pmm"</span>    <span class="string">"pmm"</span>    <span class="string">"pmm"</span>    <span class="string">"pmm"</span>    <span class="string">"pmm"</span>       <span class="string">""</span> </span></span><br><span class="line"><span class="preprocessor">##      Exp   Danger </span></span><br><span class="line"><span class="preprocessor">##       <span class="string">""</span>       <span class="string">""</span> </span></span><br><span class="line"><span class="preprocessor">## VisitSequence:</span></span><br><span class="line"><span class="preprocessor">##  NonD Dream Sleep  Span  Gest </span></span><br><span class="line"><span class="preprocessor">##     <span class="number">3</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">6</span>     <span class="number">7</span> </span></span><br><span class="line"><span class="preprocessor">## PredictorMatrix:</span></span><br><span class="line"><span class="preprocessor">##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger</span></span><br><span class="line"><span class="preprocessor">## BodyWgt        <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">## BrainWgt       <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">## NonD           <span class="number">1</span>        <span class="number">1</span>    <span class="number">0</span>     <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## Dream          <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>     <span class="number">0</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## Sleep          <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>     <span class="number">1</span>     <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## Span           <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>     <span class="number">1</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## Gest           <span class="number">1</span>        <span class="number">1</span>    <span class="number">1</span>     <span class="number">1</span>     <span class="number">1</span>    <span class="number">1</span>    <span class="number">0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## Pred           <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">## Exp            <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">## Danger         <span class="number">0</span>        <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span></span><br><span class="line"><span class="preprocessor">## Random generator seed value:  <span class="number">1234</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp$imp$Dream</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##      <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>  <span class="number">1.0</span> <span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>  <span class="number">2.6</span> <span class="number">2.1</span> <span class="number">1.5</span> <span class="number">1.8</span> <span class="number">1.3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>  <span class="number">3.4</span> <span class="number">3.1</span> <span class="number">3.4</span> <span class="number">1.2</span> <span class="number">3.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span> <span class="number">0.3</span> <span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.3</span> <span class="number">1.2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">24</span> <span class="number">1.8</span> <span class="number">1.3</span> <span class="number">3.6</span> <span class="number">0.9</span> <span class="number">5.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">26</span> <span class="number">2.3</span> <span class="number">3.1</span> <span class="number">2.0</span> <span class="number">2.6</span> <span class="number">2.1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">30</span> <span class="number">1.2</span> <span class="number">0.3</span> <span class="number">3.4</span> <span class="number">2.6</span> <span class="number">2.3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">31</span> <span class="number">3.4</span> <span class="number">0.5</span> <span class="number">0.6</span> <span class="number">1.0</span> <span class="number">0.5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">47</span> <span class="number">0.5</span> <span class="number">1.5</span> <span class="number">1.5</span> <span class="number">2.2</span> <span class="number">3.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">53</span> <span class="number">0.3</span> <span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.6</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">55</span> <span class="number">0.5</span> <span class="number">0.9</span> <span class="number">2.6</span> <span class="number">2.7</span> <span class="number">2.4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">62</span> <span class="number">1.0</span> <span class="number">2.1</span> <span class="number">0.5</span> <span class="number">3.9</span> <span class="number">3.6</span></span></span><br></pre></td></tr></table></figure>
<p>利用complete()函数可观察m个插补数据集中的任意一个，格式为：complete(imp,action=#)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">complete(imp,action=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##     BodyWgt BrainWgt NonD Dream Sleep  Span  Gest Pred Exp Danger</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>  <span class="number">6654.000</span>  <span class="number">5712.00</span>  <span class="number">2.1</span>   <span class="number">0.5</span>   <span class="number">3.3</span>  <span class="number">38.6</span> <span class="number">645.0</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">2</span>     <span class="number">1.000</span>     <span class="number">6.60</span>  <span class="number">6.3</span>   <span class="number">2.0</span>   <span class="number">8.3</span>   <span class="number">4.5</span>  <span class="number">42.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>     <span class="number">3.385</span>    <span class="number">44.50</span> <span class="number">11.0</span>   <span class="number">1.5</span>  <span class="number">12.5</span>  <span class="number">14.0</span>  <span class="number">60.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>     <span class="number">0.920</span>     <span class="number">5.70</span> <span class="number">13.2</span>   <span class="number">3.4</span>  <span class="number">16.5</span>   <span class="number">2.0</span>  <span class="number">25.0</span>    <span class="number">5</span>   <span class="number">2</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">5</span>  <span class="number">2547.000</span>  <span class="number">4603.00</span>  <span class="number">2.1</span>   <span class="number">1.8</span>   <span class="number">3.9</span>  <span class="number">69.0</span> <span class="number">624.0</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">6</span>    <span class="number">10.550</span>   <span class="number">179.50</span>  <span class="number">9.1</span>   <span class="number">0.7</span>   <span class="number">9.8</span>  <span class="number">27.0</span> <span class="number">180.0</span>    <span class="number">4</span>   <span class="number">4</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">7</span>     <span class="number">0.023</span>     <span class="number">0.30</span> <span class="number">15.8</span>   <span class="number">3.9</span>  <span class="number">19.7</span>  <span class="number">19.0</span>  <span class="number">35.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">8</span>   <span class="number">160.000</span>   <span class="number">169.00</span>  <span class="number">5.2</span>   <span class="number">1.0</span>   <span class="number">6.2</span>  <span class="number">30.4</span> <span class="number">392.0</span>    <span class="number">4</span>   <span class="number">5</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">9</span>     <span class="number">3.300</span>    <span class="number">25.60</span> <span class="number">10.9</span>   <span class="number">3.6</span>  <span class="number">14.5</span>  <span class="number">28.0</span>  <span class="number">63.0</span>    <span class="number">1</span>   <span class="number">2</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">10</span>   <span class="number">52.160</span>   <span class="number">440.00</span>  <span class="number">8.3</span>   <span class="number">1.4</span>   <span class="number">9.7</span>  <span class="number">50.0</span> <span class="number">230.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">11</span>    <span class="number">0.425</span>     <span class="number">6.40</span> <span class="number">11.0</span>   <span class="number">1.5</span>  <span class="number">12.5</span>   <span class="number">7.0</span> <span class="number">112.0</span>    <span class="number">5</span>   <span class="number">4</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">12</span>  <span class="number">465.000</span>   <span class="number">423.00</span>  <span class="number">3.2</span>   <span class="number">0.7</span>   <span class="number">3.9</span>  <span class="number">30.0</span> <span class="number">281.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">13</span>    <span class="number">0.550</span>     <span class="number">2.40</span>  <span class="number">7.6</span>   <span class="number">2.7</span>  <span class="number">10.3</span>  <span class="number">18.0</span>  <span class="number">46.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>  <span class="number">187.100</span>   <span class="number">419.00</span>  <span class="number">3.3</span>   <span class="number">0.5</span>   <span class="number">3.1</span>  <span class="number">40.0</span> <span class="number">365.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">15</span>    <span class="number">0.075</span>     <span class="number">1.20</span>  <span class="number">6.3</span>   <span class="number">2.1</span>   <span class="number">8.4</span>   <span class="number">3.5</span>  <span class="number">42.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">16</span>    <span class="number">3.000</span>    <span class="number">25.00</span>  <span class="number">8.6</span>   <span class="number">0.0</span>   <span class="number">8.6</span>  <span class="number">50.0</span>  <span class="number">28.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">17</span>    <span class="number">0.785</span>     <span class="number">3.50</span>  <span class="number">6.6</span>   <span class="number">4.1</span>  <span class="number">10.7</span>   <span class="number">6.0</span>  <span class="number">42.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">18</span>    <span class="number">0.200</span>     <span class="number">5.00</span>  <span class="number">9.5</span>   <span class="number">1.2</span>  <span class="number">10.7</span>  <span class="number">10.4</span> <span class="number">120.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">19</span>    <span class="number">1.410</span>    <span class="number">17.50</span>  <span class="number">4.8</span>   <span class="number">1.3</span>   <span class="number">6.1</span>  <span class="number">34.0</span>  <span class="number">28.0</span>    <span class="number">1</span>   <span class="number">2</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">20</span>   <span class="number">60.000</span>    <span class="number">81.00</span> <span class="number">12.0</span>   <span class="number">6.1</span>  <span class="number">18.1</span>   <span class="number">7.0</span>  <span class="number">21.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">21</span>  <span class="number">529.000</span>   <span class="number">680.00</span> <span class="number">11.0</span>   <span class="number">0.3</span>  <span class="number">10.8</span>  <span class="number">28.0</span> <span class="number">400.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">22</span>   <span class="number">27.660</span>   <span class="number">115.00</span>  <span class="number">3.3</span>   <span class="number">0.5</span>   <span class="number">3.8</span>  <span class="number">20.0</span> <span class="number">148.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">23</span>    <span class="number">0.120</span>     <span class="number">1.00</span> <span class="number">11.0</span>   <span class="number">3.4</span>  <span class="number">14.4</span>   <span class="number">3.9</span>  <span class="number">16.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">24</span>  <span class="number">207.000</span>   <span class="number">406.00</span>  <span class="number">8.2</span>   <span class="number">3.6</span>  <span class="number">12.0</span>  <span class="number">39.3</span> <span class="number">252.0</span>    <span class="number">1</span>   <span class="number">4</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">25</span>   <span class="number">85.000</span>   <span class="number">325.00</span>  <span class="number">4.7</span>   <span class="number">1.5</span>   <span class="number">6.2</span>  <span class="number">41.0</span> <span class="number">310.0</span>    <span class="number">1</span>   <span class="number">3</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">26</span>   <span class="number">36.330</span>   <span class="number">119.50</span> <span class="number">11.0</span>   <span class="number">2.0</span>  <span class="number">13.0</span>  <span class="number">16.2</span>  <span class="number">63.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">27</span>    <span class="number">0.101</span>     <span class="number">4.00</span> <span class="number">10.4</span>   <span class="number">3.4</span>  <span class="number">13.8</span>   <span class="number">9.0</span>  <span class="number">28.0</span>    <span class="number">5</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">28</span>    <span class="number">1.040</span>     <span class="number">5.50</span>  <span class="number">7.4</span>   <span class="number">0.8</span>   <span class="number">8.2</span>   <span class="number">7.6</span>  <span class="number">68.0</span>    <span class="number">5</span>   <span class="number">3</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">29</span>  <span class="number">521.000</span>   <span class="number">655.00</span>  <span class="number">2.1</span>   <span class="number">0.8</span>   <span class="number">2.9</span>  <span class="number">46.0</span> <span class="number">336.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">30</span>  <span class="number">100.000</span>   <span class="number">157.00</span>  <span class="number">7.4</span>   <span class="number">3.4</span>  <span class="number">10.8</span>  <span class="number">22.4</span> <span class="number">100.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">31</span>   <span class="number">35.000</span>    <span class="number">56.00</span>  <span class="number">3.3</span>   <span class="number">0.6</span>   <span class="number">3.8</span>  <span class="number">16.3</span>  <span class="number">33.0</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">32</span>    <span class="number">0.005</span>     <span class="number">0.14</span>  <span class="number">7.7</span>   <span class="number">1.4</span>   <span class="number">9.1</span>   <span class="number">2.6</span>  <span class="number">21.5</span>    <span class="number">5</span>   <span class="number">2</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">33</span>    <span class="number">0.010</span>     <span class="number">0.25</span> <span class="number">17.9</span>   <span class="number">2.0</span>  <span class="number">19.9</span>  <span class="number">24.0</span>  <span class="number">50.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">34</span>   <span class="number">62.000</span>  <span class="number">1320.00</span>  <span class="number">6.1</span>   <span class="number">1.9</span>   <span class="number">8.0</span> <span class="number">100.0</span> <span class="number">267.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">35</span>    <span class="number">0.122</span>     <span class="number">3.00</span>  <span class="number">8.2</span>   <span class="number">2.4</span>  <span class="number">10.6</span>  <span class="number">12.7</span>  <span class="number">30.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">36</span>    <span class="number">1.350</span>     <span class="number">8.10</span>  <span class="number">8.4</span>   <span class="number">2.8</span>  <span class="number">11.2</span>   <span class="number">4.5</span>  <span class="number">45.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">37</span>    <span class="number">0.023</span>     <span class="number">0.40</span> <span class="number">11.9</span>   <span class="number">1.3</span>  <span class="number">13.2</span>   <span class="number">3.2</span>  <span class="number">19.0</span>    <span class="number">4</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">38</span>    <span class="number">0.048</span>     <span class="number">0.33</span> <span class="number">10.8</span>   <span class="number">2.0</span>  <span class="number">12.8</span>   <span class="number">2.0</span>  <span class="number">30.0</span>    <span class="number">4</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">39</span>    <span class="number">1.700</span>     <span class="number">6.30</span> <span class="number">13.8</span>   <span class="number">5.6</span>  <span class="number">19.4</span>   <span class="number">5.0</span>  <span class="number">12.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">40</span>    <span class="number">3.500</span>    <span class="number">10.80</span> <span class="number">14.3</span>   <span class="number">3.1</span>  <span class="number">17.4</span>   <span class="number">6.5</span> <span class="number">120.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">41</span>  <span class="number">250.000</span>   <span class="number">490.00</span>  <span class="number">7.7</span>   <span class="number">1.0</span>   <span class="number">8.4</span>  <span class="number">23.6</span> <span class="number">440.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">42</span>    <span class="number">0.480</span>    <span class="number">15.50</span> <span class="number">15.2</span>   <span class="number">1.8</span>  <span class="number">17.0</span>  <span class="number">12.0</span> <span class="number">140.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">43</span>   <span class="number">10.000</span>   <span class="number">115.00</span> <span class="number">10.0</span>   <span class="number">0.9</span>  <span class="number">10.9</span>  <span class="number">20.2</span> <span class="number">170.0</span>    <span class="number">4</span>   <span class="number">4</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">44</span>    <span class="number">1.620</span>    <span class="number">11.40</span> <span class="number">11.9</span>   <span class="number">1.8</span>  <span class="number">13.7</span>  <span class="number">13.0</span>  <span class="number">17.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">45</span>  <span class="number">192.000</span>   <span class="number">180.00</span>  <span class="number">6.5</span>   <span class="number">1.9</span>   <span class="number">8.4</span>  <span class="number">27.0</span> <span class="number">115.0</span>    <span class="number">4</span>   <span class="number">4</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">46</span>    <span class="number">2.500</span>    <span class="number">12.10</span>  <span class="number">7.5</span>   <span class="number">0.9</span>   <span class="number">8.4</span>  <span class="number">18.0</span>  <span class="number">31.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">47</span>    <span class="number">4.288</span>    <span class="number">39.20</span> <span class="number">11.0</span>   <span class="number">1.5</span>  <span class="number">12.5</span>  <span class="number">13.7</span>  <span class="number">63.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">48</span>    <span class="number">0.280</span>     <span class="number">1.90</span> <span class="number">10.6</span>   <span class="number">2.6</span>  <span class="number">13.2</span>   <span class="number">4.7</span>  <span class="number">21.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">49</span>    <span class="number">4.235</span>    <span class="number">50.40</span>  <span class="number">7.4</span>   <span class="number">2.4</span>   <span class="number">9.8</span>   <span class="number">9.8</span>  <span class="number">52.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">50</span>    <span class="number">6.800</span>   <span class="number">179.00</span>  <span class="number">8.4</span>   <span class="number">1.2</span>   <span class="number">9.6</span>  <span class="number">29.0</span> <span class="number">164.0</span>    <span class="number">2</span>   <span class="number">3</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">51</span>    <span class="number">0.750</span>    <span class="number">12.30</span>  <span class="number">5.7</span>   <span class="number">0.9</span>   <span class="number">6.6</span>   <span class="number">7.0</span> <span class="number">225.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">52</span>    <span class="number">3.600</span>    <span class="number">21.00</span>  <span class="number">4.9</span>   <span class="number">0.5</span>   <span class="number">5.4</span>   <span class="number">6.0</span> <span class="number">225.0</span>    <span class="number">3</span>   <span class="number">2</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">53</span>   <span class="number">14.830</span>    <span class="number">98.20</span>  <span class="number">2.1</span>   <span class="number">0.5</span>   <span class="number">2.6</span>  <span class="number">17.0</span> <span class="number">150.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">54</span>   <span class="number">55.500</span>   <span class="number">175.00</span>  <span class="number">3.2</span>   <span class="number">0.6</span>   <span class="number">3.8</span>  <span class="number">20.0</span> <span class="number">151.0</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">55</span>    <span class="number">1.400</span>    <span class="number">12.50</span>  <span class="number">8.4</span>   <span class="number">2.6</span>  <span class="number">11.0</span>  <span class="number">12.7</span>  <span class="number">90.0</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">56</span>    <span class="number">0.060</span>     <span class="number">1.00</span>  <span class="number">8.1</span>   <span class="number">2.2</span>  <span class="number">10.3</span>   <span class="number">3.5</span> <span class="number">100.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">57</span>    <span class="number">0.900</span>     <span class="number">2.60</span> <span class="number">11.0</span>   <span class="number">2.3</span>  <span class="number">13.3</span>   <span class="number">4.5</span>  <span class="number">60.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">58</span>    <span class="number">2.000</span>    <span class="number">12.30</span>  <span class="number">4.9</span>   <span class="number">0.5</span>   <span class="number">5.4</span>   <span class="number">7.5</span> <span class="number">200.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">59</span>    <span class="number">0.104</span>     <span class="number">2.50</span> <span class="number">13.2</span>   <span class="number">2.6</span>  <span class="number">15.8</span>   <span class="number">2.3</span>  <span class="number">46.0</span>    <span class="number">3</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">60</span>    <span class="number">4.190</span>    <span class="number">58.00</span>  <span class="number">9.7</span>   <span class="number">0.6</span>  <span class="number">10.3</span>  <span class="number">24.0</span> <span class="number">210.0</span>    <span class="number">4</span>   <span class="number">3</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">61</span>    <span class="number">3.500</span>     <span class="number">3.90</span> <span class="number">12.8</span>   <span class="number">6.6</span>  <span class="number">19.4</span>   <span class="number">3.0</span>  <span class="number">14.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">62</span>    <span class="number">4.050</span>    <span class="number">17.00</span> <span class="number">17.9</span>   <span class="number">0.5</span>  <span class="number">19.4</span>  <span class="number">13.0</span>  <span class="number">38.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br></pre></td></tr></table></figure>
<p>下面手动将预测结果计算出来，并补全数据。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data.pre&lt;-sleep[is.na(sleep$Dream),][,<span class="number">6</span>:<span class="number">7</span>]  <span class="comment">#选取Dream为缺失样本的Span和Gest值</span></span><br><span class="line">data.pre&lt;-as.matrix(cbind(rep(<span class="number">1</span>,<span class="number">12</span>),data.pre))</span><br><span class="line">q&lt;-pooled$qbar  <span class="comment">#通过拟合回归预测Dream</span></span><br><span class="line">pre&lt;-data.pre%*%q  <span class="comment">#预测结果</span></span><br><span class="line">pre</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##      [,<span class="number">1</span>]</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>  -<span class="number">0.155</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>   <span class="number">2.248</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>      NA</span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>  <span class="number">0.935</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">24</span>  <span class="number">1.381</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">26</span>  <span class="number">2.226</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">30</span>  <span class="number">2.053</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">31</span>  <span class="number">2.343</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">47</span>  <span class="number">2.237</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">53</span>  <span class="number">1.881</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">55</span>  <span class="number">2.136</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">62</span>  <span class="number">2.338</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index&lt;-is.na(sleep$Dream)</span><br><span class="line">sleep$Dream[index]&lt;-pre  <span class="comment">#替代缺失值</span></span><br><span class="line">sleep[index,]</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##    BodyWgt BrainWgt NonD  Dream Sleep Span Gest Pred Exp Danger</span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>  <span class="number">6654.00</span>   <span class="number">5712.0</span>   NA -<span class="number">0.155</span>   <span class="number">3.3</span> <span class="number">38.6</span>  <span class="number">645</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>     <span class="number">3.38</span>     <span class="number">44.5</span>   NA  <span class="number">2.248</span>  <span class="number">12.5</span> <span class="number">14.0</span>   <span class="number">60</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">4</span>     <span class="number">0.92</span>      <span class="number">5.7</span>   NA     NA  <span class="number">16.5</span>   NA   <span class="number">25</span>    <span class="number">5</span>   <span class="number">2</span>      <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">14</span>  <span class="number">187.10</span>    <span class="number">419.0</span>   NA  <span class="number">0.935</span>   <span class="number">3.1</span> <span class="number">40.0</span>  <span class="number">365</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">24</span>  <span class="number">207.00</span>    <span class="number">406.0</span>   NA  <span class="number">1.381</span>  <span class="number">12.0</span> <span class="number">39.3</span>  <span class="number">252</span>    <span class="number">1</span>   <span class="number">4</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">26</span>   <span class="number">36.33</span>    <span class="number">119.5</span>   NA  <span class="number">2.226</span>  <span class="number">13.0</span> <span class="number">16.2</span>   <span class="number">63</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">30</span>  <span class="number">100.00</span>    <span class="number">157.0</span>   NA  <span class="number">2.053</span>  <span class="number">10.8</span> <span class="number">22.4</span>  <span class="number">100</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">31</span>   <span class="number">35.00</span>     <span class="number">56.0</span>   NA  <span class="number">2.343</span>    NA <span class="number">16.3</span>   <span class="number">33</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">47</span>    <span class="number">4.29</span>     <span class="number">39.2</span>   NA  <span class="number">2.237</span>  <span class="number">12.5</span> <span class="number">13.7</span>   <span class="number">63</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">53</span>   <span class="number">14.83</span>     <span class="number">98.2</span>   NA  <span class="number">1.881</span>   <span class="number">2.6</span> <span class="number">17.0</span>  <span class="number">150</span>    <span class="number">5</span>   <span class="number">5</span>      <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">55</span>    <span class="number">1.40</span>     <span class="number">12.5</span>   NA  <span class="number">2.136</span>  <span class="number">11.0</span> <span class="number">12.7</span>   <span class="number">90</span>    <span class="number">2</span>   <span class="number">2</span>      <span class="number">2</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">62</span>    <span class="number">4.05</span>     <span class="number">17.0</span>   NA  <span class="number">2.338</span>    NA <span class="number">13.0</span>   <span class="number">38</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">1</span></span></span><br></pre></td></tr></table></figure>
<h2 id="u5904_u7406_u7F3A_u5931_u503C_u7684_u5176_u4ED6_u65B9_u6CD5"><a href="#u5904_u7406_u7F3A_u5931_u503C_u7684_u5176_u4ED6_u65B9_u6CD5" class="headerlink" title="处理缺失值的其他方法"></a>处理缺失值的其他方法</h2><p>除了mice包，许多R程序包也提供了多重估算函数，因为不同数据类型要求的估计方法不同。</p>
<table>
<thead>
<tr>
<th>R包</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hmisc</td>
<td>包含多种函数，支持简单插补、多重插补和典型变量插补</td>
</tr>
<tr>
<td>mvnmle</td>
<td>对多元正态颁数据中缺失值的最大似然估计</td>
</tr>
<tr>
<td>norm</td>
<td>提供期望最大化算法</td>
</tr>
<tr>
<td>monomvn</td>
<td>可以估计单调多元正态数据的缺失值</td>
</tr>
<tr>
<td>cat</td>
<td>对数线性模型中多元类别型变量的多重插补</td>
</tr>
<tr>
<td>mix</td>
<td>一般位置模型中混合类别型和连续型数据的多重插补</td>
</tr>
<tr>
<td>pan</td>
<td>多元面板数据或聚类的多重插补</td>
</tr>
<tr>
<td>longitudinalData</td>
<td>相关的函数列表，比如对时间序列缺失值进行插补的一系列函数</td>
</tr>
</tbody>
</table>

      
    </div>
    
  </div>
  
    


    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/01/26/kindle_book_sort_crawler/">
                    抓取Kindle电子书销售排行榜
                </a>
            </div>
        
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#u5224_u65AD_u7F3A_u5931_u6570_u636E"><span class="toc-number">1.</span> <span class="toc-text">判断缺失数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#u8BC6_u522B_u7F3A_u5931_u503C"><span class="toc-number">1.1.</span> <span class="toc-text">识别缺失值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u4E0D_u540C_u7C7B_u578B_u6570_u636E_u8FD4_u56DE_u503C_u793A_u4F8B"><span class="toc-number">1.2.</span> <span class="toc-text">不同类型数据返回值示例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u5224_u65AD_u7F3A_u5931_u6A21_u5F0F"><span class="toc-number">2.</span> <span class="toc-text">判断缺失模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#u4ECE_u6570_u503C_u89D2_u5EA6"><span class="toc-number">2.1.</span> <span class="toc-text">从数值角度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u56FE_u5F62_u65B9_u5F0F"><span class="toc-number">2.2.</span> <span class="toc-text">图形方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#u5904_u7406_u7F3A_u5931_u6570_u636E"><span class="toc-number">3.</span> <span class="toc-text">处理缺失数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#u5220_u9664_u7F3A_u5931_u6837_u672C"><span class="toc-number">3.1.</span> <span class="toc-text">删除缺失样本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u66FF_u6362_u7F3A_u5931_u503C"><span class="toc-number">3.2.</span> <span class="toc-text">替换缺失值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u591A_u91CD_u63D2_u8865_u6CD5"><span class="toc-number">3.3.</span> <span class="toc-text">多重插补法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u5904_u7406_u7F3A_u5931_u503C_u7684_u5176_u4ED6_u65B9_u6CD5"><span class="toc-number">3.4.</span> <span class="toc-text">处理缺失值的其他方法</span></a></li></ol></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>




<div class="share">
    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
    <a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
    <a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
    <a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
    </div>
    <script>
        window._bd_share_config={
            "common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>
</div>



    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/01/19/missing_value/" data-title="R语言处理缺失数据" data-url="http://datarting.com/2016/01/19/missing_value/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"itisshmily"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/01/26/kindle_book_sort_crawler/" title="上一篇: 抓取Kindle电子书销售排行榜">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/01/28/r_parallel_computing/">R语言parallel包处理并行运算</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/kindle_book_sort_crawler/">抓取Kindle电子书销售排行榜</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/19/missing_value/">R语言处理缺失数据</a></li></ul>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 x_shmily
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>